/*! For license information please see 312.2b6e7f426a5580ce33e6.js.LICENSE.txt */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[312],{8312:(e,t,r)=>{r.r(t),r.d(t,{default:()=>j});var n=r(6540),a=r(1468),o=r(3947),i=r(2389),l=r(6386),c=r(3959),s=r(2374),u=r(9016);function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function d(){return d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},d.apply(null,arguments)}function f(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],r=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}throw new TypeError(m(e)+" is not iterable")}function y(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=N(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){l=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(l)throw o}}}}function b(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",a=r.toStringTag||"@@toStringTag";function o(r,n,a,o){var c=n&&n.prototype instanceof l?n:l,s=Object.create(c.prototype);return p(s,"_invoke",function(r,n,a){var o,l,c,s=0,u=a||[],m=!1,d={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,r){return o=t,l=0,c=e,d.n=r,i}};function f(r,n){for(l=r,c=n,t=0;!m&&s&&!a&&t<u.length;t++){var a,o=u[t],f=d.p,y=o[2];r>3?(a=y===n)&&(c=o[(l=o[4])?5:(l=3,3)],o[4]=o[5]=e):o[0]<=f&&((a=r<2&&f<o[1])?(l=0,d.v=n,d.n=o[1]):f<y&&(a=r<3||o[0]>n||n>y)&&(o[4]=r,o[5]=n,d.n=y,l=0))}if(a||r>1)return i;throw m=!0,n}return function(a,u,y){if(s>1)throw TypeError("Generator is already running");for(m&&1===u&&f(u,y),l=u,c=y;(t=l<2?e:c)||!m;){o||(l?l<3?(l>1&&(d.n=-1),f(l,c)):d.n=c:d.v=c);try{if(s=2,o){if(l||(a="next"),t=o[a]){if(!(t=t.call(o,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,l<2&&(l=0)}else 1===l&&(t=o.return)&&t.call(o),l<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),l=1);o=e}else if((t=(m=d.n<0)?c:r.call(n,d))!==i)break}catch(t){o=e,l=1,c=t}finally{s=1}}return{value:t,done:m}}}(r,a,o),!0),s}var i={};function l(){}function c(){}function s(){}t=Object.getPrototypeOf;var u=[][n]?t(t([][n]())):(p(t={},n,function(){return this}),t),m=s.prototype=l.prototype=Object.create(u);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,p(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e}return c.prototype=s,p(m,"constructor",s),p(s,"constructor",c),c.displayName="GeneratorFunction",p(s,a,"GeneratorFunction"),p(m),p(m,a,"Generator"),p(m,n,function(){return this}),p(m,"toString",function(){return"[object Generator]"}),(b=function(){return{w:o,m:d}})()}function p(e,t,r,n){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}p=function(e,t,r,n){function o(t,r){p(e,t,function(e){return this._invoke(t,r,e)})}t?a?a(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(o("next",0),o("throw",1),o("return",2))},p(e,t,r,n)}function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach(function(t){h(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function h(e,t,r){return(t=function(e){var t=function(e){if("object"!=m(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=m(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==m(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function x(e,t,r,n,a,o,i){try{var l=e[o](i),c=l.value}catch(e){return void r(e)}l.done?t(c):Promise.resolve(c).then(n,a)}function w(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var o=e.apply(t,r);function i(e){x(o,n,a,i,l,"next",e)}function l(e){x(o,n,a,i,l,"throw",e)}i(void 0)})}}function E(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o,i,l=[],c=!0,s=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,a=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw a}}return l}}(e,t)||N(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e,t){if(e){if("string"==typeof e)return k(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?k(e,t):void 0}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const j=function(){var e,t=(0,i.Bd)().t,r=(0,u.D)().isDarkMode,m=(0,a.wA)(),p=(0,a.d4)(function(e){return e.data.excelData}),g=E((0,n.useState)([]),2),x=g[0],j=g[1],S=E((0,n.useState)({}),2),O=S[0],P=S[1],A=E((0,n.useState)(!1),2),C=A[0],D=A[1],M=(0,n.useRef)(null),B=(0,n.useCallback)(function(){var e=w(b().m(function e(t){return b().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,r){var n=new FileReader;n.onprogress=function(e){if(e.lengthComputable){var r=Math.round(e.loaded/e.total*100);P(function(e){return v(v({},e),{},h({},t.name,r))})}},n.onload=function(n){try{var a=n.target.result,o=c.LF(a,{type:"binary"}),i=o.SheetNames[0],l=o.Sheets[i],s=c.Wp.sheet_to_json(l,{header:1}),u={name:t.name,size:t.size,type:t.type,lastModified:t.lastModified,data:s,uploadedAt:(new Date).toISOString()};e(u)}catch(e){r(new Error("Failed to process ".concat(t.name,": ").concat(e.message)))}},n.onerror=function(){return r(new Error("Failed to read ".concat(t.name)))},n.readAsBinaryString(t)}))},e)}));return function(t){return e.apply(this,arguments)}}(),[]),T=(0,n.useCallback)(function(){var e=w(b().m(function e(t){var r,n,a,o;return b().w(function(e){for(;;)switch(e.p=e.n){case 0:D(!0),r=y(t),e.p=1,a=b().m(function e(){var t,r,a;return b().w(function(e){for(;;)switch(e.p=e.n){case 0:return t=n.value,e.p=1,e.n=2,B(t);case 2:r=e.v,j(function(e){return[].concat(function(e){if(Array.isArray(e))return k(e)}(t=e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||N(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[r]);var t}),m((0,s.uH)(r.data)),P(function(e){var r=v({},e);return delete r[t.name],r}),e.n=4;break;case 3:e.p=3,a=e.v,console.error("Upload error:",a);case 4:return e.a(2)}},e,null,[[1,3]])}),r.s();case 2:if((n=r.n()).done){e.n=4;break}return e.d(f(a()),3);case 3:e.n=2;break;case 4:e.n=6;break;case 5:e.p=5,o=e.v,r.e(o);case 6:return e.p=6,r.f(),e.f(6);case 7:D(!1);case 8:return e.a(2)}},e,null,[[1,5,6,7]])}));return function(t){return e.apply(this,arguments)}}(),[B,m]),F=(0,l.VB)({onDrop:T,accept:{"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"application/vnd.ms-excel":[".xls"]},multiple:!0,disabled:C}),L=F.getRootProps,I=F.getInputProps,_=F.isDragActive,G={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}},U={idle:{scale:1,borderColor:r?"#4B5563":"#D1D5DB"},active:{scale:1.02,borderColor:"#3B82F6",backgroundColor:r?"rgba(59, 130, 246, 0.1)":"rgba(59, 130, 246, 0.05)"}};return n.createElement(o.motion.div,{className:"space-y-8",variants:{hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},initial:"hidden",animate:"visible"},n.createElement(o.motion.div,{className:"text-center",variants:G},n.createElement("h1",{className:"text-3xl font-bold mb-2 ".concat(r?"text-white":"text-gray-900")},t("Upload Excel Files")),n.createElement("p",{className:"text-lg ".concat(r?"text-gray-300":"text-gray-600")},t("Drag and drop your Excel files here or click to select files"))),n.createElement(o.motion.div,{variants:U,animate:_?"active":"idle",transition:{duration:.2}},n.createElement("div",d({},L(),{className:"relative border-2 border-dashed rounded-2xl p-12 text-center cursor-pointer transition-all duration-300 ".concat(_?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-300 dark:border-gray-600 ".concat(r?"bg-gray-800":"bg-gray-50")," ").concat(C?"pointer-events-none opacity-50":"")}),n.createElement("input",d({},I(),{ref:M})),n.createElement(o.motion.div,{className:"flex flex-col items-center space-y-4",animate:_?{scale:1.05}:{scale:1},transition:{duration:.2}},n.createElement(o.motion.div,{className:"w-20 h-20 rounded-full flex items-center justify-center ".concat(_?"bg-blue-500 text-white":r?"bg-gray-700 text-gray-300":"bg-gray-200 text-gray-600"),animate:_?{rotate:[0,-10,10,0]}:{},transition:{duration:.5}},n.createElement("svg",{className:"w-10 h-10",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"}))),n.createElement("div",null,n.createElement("p",{className:"text-xl font-semibold mb-2 ".concat(r?"text-white":"text-gray-900")},t(_?"Drop your files here":"Drag & drop files here")),n.createElement("p",{className:"".concat(r?"text-gray-400":"text-gray-500")},t("or click to select files")),n.createElement("p",{className:"text-sm mt-2 ".concat(r?"text-gray-500":"text-gray-400")},t("Supported formats"),": .xlsx, .xls")),n.createElement(o.motion.button,{onClick:function(){var e;null===(e=M.current)||void 0===e||e.click()},className:"px-6 py-3 rounded-lg font-semibold transition-all duration-300 ".concat(r?"bg-blue-600 hover:bg-blue-700 text-white":"bg-blue-500 hover:bg-blue-600 text-white"),whileHover:{scale:1.05},whileTap:{scale:.95},disabled:C},t("Choose Files"))),n.createElement(o.AnimatePresence,null,C&&n.createElement(o.motion.div,{className:"absolute inset-0 bg-white bg-opacity-90 dark:bg-gray-800 dark:bg-opacity-90 rounded-2xl flex items-center justify-center",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}},n.createElement("div",{className:"text-center"},n.createElement(o.motion.div,{className:"w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full mx-auto mb-4",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}}),n.createElement("p",{className:"font-semibold ".concat("text-gray-900")},t("Processing files..."))))))),n.createElement(o.AnimatePresence,null,x.length>0&&n.createElement(o.motion.div,{variants:G,initial:"hidden",animate:"visible",exit:"hidden"},n.createElement("h2",{className:"text-2xl font-bold mb-6 ".concat(r?"text-white":"text-gray-900")},t("Uploaded Files")),n.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},n.createElement(o.AnimatePresence,null,x.map(function(e,a){var i;return n.createElement(o.motion.div,{key:e.name,className:"relative ".concat(r?"bg-gray-800 border-gray-700":"bg-white border-gray-200"," border rounded-xl p-6 shadow-lg hover:shadow-xl transition-all duration-300"),initial:{opacity:0,scale:.8,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.8,y:-20},transition:{delay:.1*a,duration:.5},whileHover:{scale:1.02}},n.createElement("div",{className:"flex items-center justify-between mb-4"},n.createElement("div",{className:"flex items-center space-x-3"},n.createElement("div",{className:"w-12 h-12 bg-green-100 dark:bg-green-800 rounded-lg flex items-center justify-center"},n.createElement("svg",{className:"w-6 h-6 text-green-600 dark:text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"}))),n.createElement("div",null,n.createElement("h3",{className:"font-semibold text-sm ".concat(r?"text-white":"text-gray-900"," truncate max-w-32")},e.name),n.createElement("p",{className:"text-xs ".concat(r?"text-gray-400":"text-gray-500")},function(e){if(0===e)return"0 Bytes";var t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]}(e.size)))),n.createElement(o.motion.button,{onClick:function(){return t=e.name,void j(function(e){return e.filter(function(e){return e.name!==t})});var t},className:"p-2 rounded-lg ".concat(r?"hover:bg-gray-700":"hover:bg-gray-100"," transition-colors"),whileHover:{scale:1.1},whileTap:{scale:.9}},n.createElement("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})))),n.createElement("div",{className:"space-y-2"},n.createElement("div",{className:"flex justify-between text-sm"},n.createElement("span",{className:r?"text-gray-400":"text-gray-600"},t("Rows"),":"),n.createElement("span",{className:"font-semibold ".concat(r?"text-white":"text-gray-900")},e.data.length)),n.createElement("div",{className:"flex justify-between text-sm"},n.createElement("span",{className:r?"text-gray-400":"text-gray-600"},t("Columns"),":"),n.createElement("span",{className:"font-semibold ".concat(r?"text-white":"text-gray-900")},(null===(i=e.data[0])||void 0===i?void 0:i.length)||0)),n.createElement("div",{className:"flex justify-between text-sm"},n.createElement("span",{className:r?"text-gray-400":"text-gray-600"},t("Uploaded"),":"),n.createElement("span",{className:"font-semibold ".concat(r?"text-white":"text-gray-900")},new Date(e.uploadedAt).toLocaleTimeString()))),O[e.name]&&O[e.name]<100&&n.createElement("div",{className:"mt-4"},n.createElement("div",{className:"flex justify-between text-sm mb-1"},n.createElement("span",{className:r?"text-gray-400":"text-gray-600"},t("Upload Progress")),n.createElement("span",{className:"font-semibold ".concat(r?"text-white":"text-gray-900")},O[e.name],"%")),n.createElement("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2"},n.createElement(o.motion.div,{className:"bg-blue-500 h-2 rounded-full",initial:{width:0},animate:{width:"".concat(O[e.name],"%")},transition:{duration:.5}}))))}))))),n.createElement(o.AnimatePresence,null,p.length>0&&n.createElement(o.motion.div,{variants:G,initial:"hidden",animate:"visible",exit:"hidden"},n.createElement("h2",{className:"text-2xl font-bold mb-6 ".concat(r?"text-white":"text-gray-900")},t("Data Preview")),n.createElement(o.motion.div,{className:"overflow-x-auto rounded-xl border ".concat(r?"border-gray-700 bg-gray-800":"border-gray-200 bg-white"," shadow-lg"),initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2}},n.createElement("table",{className:"min-w-full"},n.createElement("thead",{className:r?"bg-gray-700":"bg-gray-50"},n.createElement("tr",null,null===(e=p[0])||void 0===e?void 0:e.map(function(e,t){return n.createElement("th",{key:t,className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider ".concat(r?"text-gray-300 border-gray-600":"text-gray-500 border-gray-200"," border-b")},e||"Column ".concat(t+1))}))),n.createElement("tbody",{className:r?"bg-gray-800":"bg-white"},p.slice(1,6).map(function(e,t){return n.createElement(o.motion.tr,{key:t,className:t%2==0?r?"bg-gray-750":"bg-gray-50":"",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1*t}},e.map(function(e,t){return n.createElement("td",{key:t,className:"px-6 py-4 whitespace-nowrap text-sm ".concat(r?"text-gray-300 border-gray-600":"text-gray-900 border-gray-200"," border-b")},e)}))}))),p.length>6&&n.createElement("div",{className:"px-6 py-3 ".concat(r?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"," border-t text-center")},n.createElement("span",{className:"text-sm ".concat(r?"text-gray-400":"text-gray-500")},t("Showing first 5 rows of")," ",p.length-1," ",t("total rows")))))))}}}]);